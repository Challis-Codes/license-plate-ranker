<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State License Plate Battle</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .progress-bar {
            background: rgba(255,255,255,0.2);
            height: 8px;
            border-radius: 4px;
            margin-top: 15px;
            overflow: hidden;
        }

        .progress-fill {
            background: white;
            height: 100%;
            transition: width 0.3s;
            border-radius: 4px;
        }

        .progress-text {
            margin-top: 8px;
            font-size: 0.9em;
            opacity: 0.9;
        }

        .battle-container {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 30px;
            align-items: center;
            margin-bottom: 30px;
        }

        .plate-option {
            background: white;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .plate-option::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #667eea22, #764ba222);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .plate-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0,0,0,0.2);
        }

        .plate-option:hover::before {
            opacity: 1;
        }

        .plate-option:active {
            transform: translateY(-2px);
        }

        .plate-image {
            width: 280px;
            height: 140px;
            background: linear-gradient(135deg, #cbd5e1, #94a3b8);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            color: #1e293b;
            font-weight: bold;
            margin: 0 auto 20px;
            padding: 10px;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .plate-name {
            font-size: 1.5em;
            font-weight: 600;
            color: #1e293b;
            margin-bottom: 10px;
            position: relative;
            z-index: 1;
        }

        .plate-stats {
            color: #64748b;
            font-size: 0.9em;
            position: relative;
            z-index: 1;
        }

        .vs-divider {
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .controls {
            text-align: center;
            margin-bottom: 30px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
            margin: 0 10px;
        }

        .btn-primary {
            background: white;
            color: #667eea;
        }

        .btn-primary:hover {
            background: #f8fafc;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn-secondary {
            background: rgba(255,255,255,0.2);
            color: white;
        }

        .btn-secondary:hover {
            background: rgba(255,255,255,0.3);
        }

        .results-container {
            display: none;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .results-container.active {
            display: block;
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .results-header h2 {
            color: #1e293b;
            font-size: 2em;
        }

        .ranking-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .ranking-item {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 15px;
            background: #f8fafc;
            border-radius: 8px;
            transition: all 0.2s;
        }

        .ranking-item:hover {
            background: #eef2ff;
            transform: translateX(5px);
        }

        .rank-medal {
            font-size: 2em;
            width: 50px;
            text-align: center;
        }

        .rank-number {
            background: #667eea;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2em;
        }

        .rank-info {
            flex: 1;
        }

        .rank-state {
            font-weight: 600;
            font-size: 1.1em;
            color: #1e293b;
            margin-bottom: 4px;
        }

        .rank-record {
            color: #64748b;
            font-size: 0.9em;
        }

        .rank-score {
            background: #eef2ff;
            color: #667eea;
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
        }

        .intro-screen {
            background: white;
            border-radius: 12px;
            padding: 50px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto;
        }

        .intro-screen h2 {
            color: #1e293b;
            font-size: 2em;
            margin-bottom: 20px;
        }

        .intro-screen p {
            color: #64748b;
            font-size: 1.1em;
            line-height: 1.6;
            margin-bottom: 30px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .battle-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .vs-divider {
                transform: rotate(90deg);
            }

            .plate-image {
                width: 220px;
                height: 110px;
            }

            h1 {
                font-size: 1.8em;
            }
        }

        .skip-button {
            margin-top: 20px;
        }

        .keyboard-hint {
            color: white;
            text-align: center;
            margin-top: 15px;
            font-size: 0.9em;
            opacity: 0.8;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üèÜ License Plate Battle üèÜ</h1>
            <p class="subtitle">Choose your favorite between two plates</p>
            <div class="progress-bar">
                <div class="progress-fill" id="progress-fill"></div>
            </div>
            <div class="progress-text" id="progress-text">0 comparisons made</div>
        </header>

        <!-- Intro Screen -->
        <div class="intro-screen" id="intro-screen">
            <h2>Welcome to License Plate Battle!</h2>
            <p>You'll be shown two state license plates at a time. Simply click on the one you prefer!</p>
            <p>After you make enough comparisons, we'll calculate your complete rankings based on all your choices.</p>
            <p><strong>Tip:</strong> You can use the Left/Right arrow keys or A/D keys for quick voting!</p>
            <button class="btn-primary" onclick="startBattle()" style="font-size: 1.2em; padding: 15px 40px;">Start Battle</button>
        </div>

        <!-- Battle Screen -->
        <div id="battle-screen" class="hidden">
            <div class="battle-container">
                <div class="plate-option" id="option-left" onclick="chooseWinner('left')">
                    <div class="plate-image" id="plate-img-left"></div>
                    <div class="plate-name" id="plate-name-left"></div>
                    <div class="plate-stats" id="plate-stats-left">No battles yet</div>
                </div>

                <div class="vs-divider">VS</div>

                <div class="plate-option" id="option-right" onclick="chooseWinner('right')">
                    <div class="plate-image" id="plate-img-right"></div>
                    <div class="plate-name" id="plate-name-right"></div>
                    <div class="plate-stats" id="plate-stats-right">No battles yet</div>
                </div>
            </div>

            <div class="keyboard-hint">
                Press ‚Üê or A for left | Press ‚Üí or D for right | Press S to skip
            </div>

            <div class="controls">
                <button class="btn-secondary skip-button" onclick="skipBattle()">Skip This Matchup</button>
                <button class="btn-primary" onclick="showResults()">View Current Rankings</button>
                <button class="btn-secondary" onclick="resetBattle()">Start Over</button>
            </div>
        </div>

        <!-- Results Screen -->
        <div class="results-container" id="results-screen">
            <div class="results-header">
                <h2>üèÖ Your Rankings</h2>
                <div>
                    <button class="btn-secondary" onclick="exportRankings()">üíæ Export</button>
                    <button class="btn-primary" onclick="continueBattle()">Continue Voting</button>
                </div>
            </div>
            <div class="ranking-list" id="ranking-list"></div>
        </div>
    </div>

    <script>
        const states = [
            'Alabama', 'Alaska', 'Arizona', 'Arkansas', 'California',
            'Colorado', 'Connecticut', 'Delaware', 'Florida', 'Georgia',
            'Hawaii', 'Idaho', 'Illinois', 'Indiana', 'Iowa',
            'Kansas', 'Kentucky', 'Louisiana', 'Maine', 'Maryland',
            'Massachusetts', 'Michigan', 'Minnesota', 'Mississippi', 'Missouri',
            'Montana', 'Nebraska', 'Nevada', 'New Hampshire', 'New Jersey',
            'New Mexico', 'New York', 'North Carolina', 'North Dakota', 'Ohio',
            'Oklahoma', 'Oregon', 'Pennsylvania', 'Rhode Island', 'South Carolina',
            'South Dakota', 'Tennessee', 'Texas', 'Utah', 'Vermont',
            'Virginia', 'Washington', 'West Virginia', 'Wisconsin', 'Wyoming'
        ];

        let ratings = {};
        let matchHistory = [];
        let currentPair = null;
        let totalComparisons = 0;

        // Initialize ratings (ELO-style, starting at 1500)
        function initializeRatings() {
            states.forEach(state => {
                ratings[state] = {
                    score: 1500,
                    wins: 0,
                    losses: 0,
                    battles: 0
                };
            });
        }

        function startBattle() {
            document.getElementById('intro-screen').classList.add('hidden');
            document.getElementById('battle-screen').classList.remove('hidden');
            initializeRatings();
            loadNewPair();
        }

        function getRandomPair() {
            const shuffled = [...states].sort(() => Math.random() - 0.5);
            return [shuffled[0], shuffled[1]];
        }

        function loadNewPair() {
            currentPair = getRandomPair();
            
            document.getElementById('plate-img-left').textContent = currentPair[0];
            document.getElementById('plate-name-left').textContent = currentPair[0];
            document.getElementById('plate-img-right').textContent = currentPair[1];
            document.getElementById('plate-name-right').textContent = currentPair[1];

            updateStats(currentPair[0], 'left');
            updateStats(currentPair[1], 'right');
        }

        function updateStats(state, side) {
            const stats = ratings[state];
            const statsText = stats.battles > 0 
                ? `${stats.wins}W - ${stats.losses}L | Score: ${Math.round(stats.score)}`
                : 'No battles yet';
            
            document.getElementById(`plate-stats-${side}`).textContent = statsText;
        }

        function chooseWinner(side) {
            const winner = side === 'left' ? currentPair[0] : currentPair[1];
            const loser = side === 'left' ? currentPair[1] : currentPair[0];

            updateRatings(winner, loser);
            matchHistory.push({ winner, loser, timestamp: Date.now() });
            totalComparisons++;
            updateProgress();

            // Add a brief animation
            const winnerEl = document.getElementById(`option-${side}`);
            winnerEl.style.background = '#d4edda';
            setTimeout(() => {
                winnerEl.style.background = 'white';
                loadNewPair();
            }, 300);
        }

        function updateRatings(winner, loser) {
            const K = 32; // K-factor for ELO
            const winnerRating = ratings[winner].score;
            const loserRating = ratings[loser].score;

            const expectedWinner = 1 / (1 + Math.pow(10, (loserRating - winnerRating) / 400));
            const expectedLoser = 1 / (1 + Math.pow(10, (winnerRating - loserRating) / 400));

            ratings[winner].score += K * (1 - expectedWinner);
            ratings[loser].score += K * (0 - expectedLoser);

            ratings[winner].wins++;
            ratings[winner].battles++;
            ratings[loser].losses++;
            ratings[loser].battles++;
        }

        function skipBattle() {
            loadNewPair();
        }

        function updateProgress() {
            const minComparisons = states.length * 2; // Rough minimum for decent rankings
            const progress = Math.min((totalComparisons / minComparisons) * 100, 100);
            document.getElementById('progress-fill').style.width = progress + '%';
            document.getElementById('progress-text').textContent = 
                `${totalComparisons} comparison${totalComparisons !== 1 ? 's' : ''} made`;
        }

        function showResults() {
            if (totalComparisons === 0) {
                alert('Make at least one comparison before viewing rankings!');
                return;
            }

            document.getElementById('battle-screen').classList.add('hidden');
            document.getElementById('results-screen').classList.add('active');

            const rankingList = document.getElementById('ranking-list');
            rankingList.innerHTML = '';

            const sortedStates = states
                .map(state => ({ state, ...ratings[state] }))
                .sort((a, b) => b.score - a.score);

            sortedStates.forEach((item, index) => {
                const rankItem = document.createElement('div');
                rankItem.className = 'ranking-item';

                let rankDisplay;
                if (index === 0) {
                    rankDisplay = '<div class="rank-medal">ü•á</div>';
                } else if (index === 1) {
                    rankDisplay = '<div class="rank-medal">ü•à</div>';
                } else if (index === 2) {
                    rankDisplay = '<div class="rank-medal">ü•â</div>';
                } else {
                    rankDisplay = `<div class="rank-number">${index + 1}</div>`;
                }

                const record = item.battles > 0 
                    ? `${item.wins}W - ${item.losses}L`
                    : 'Not yet ranked';

                rankItem.innerHTML = `
                    ${rankDisplay}
                    <div class="rank-info">
                        <div class="rank-state">${item.state}</div>
                        <div class="rank-record">${record}</div>
                    </div>
                    <div class="rank-score">${Math.round(item.score)}</div>
                `;

                rankingList.appendChild(rankItem);
            });
        }

        function continueBattle() {
            document.getElementById('results-screen').classList.remove('active');
            document.getElementById('battle-screen').classList.remove('hidden');
            loadNewPair();
        }

        function resetBattle() {
            if (!confirm('Are you sure? This will reset all your rankings!')) {
                return;
            }
            
            initializeRatings();
            matchHistory = [];
            totalComparisons = 0;
            updateProgress();
            loadNewPair();
        }

        function exportRankings() {
            const sortedStates = states
                .map(state => ({ state, ...ratings[state] }))
                .sort((a, b) => b.score - a.score);

            let text = 'My License Plate Rankings\n';
            text += '='.repeat(40) + '\n\n';
            text += `Total Comparisons: ${totalComparisons}\n\n`;

            sortedStates.forEach((item, index) => {
                const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : `${index + 1}.`;
                const record = item.battles > 0 ? ` (${item.wins}W-${item.losses}L)` : '';
                text += `${medal} ${item.state} - Score: ${Math.round(item.score)}${record}\n`;
            });

            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'license-plate-rankings.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (document.getElementById('battle-screen').classList.contains('hidden')) return;

            if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
                chooseWinner('left');
            } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
                chooseWinner('right');
            } else if (e.key === 's' || e.key === 'S') {
                skipBattle();
            }
        });
    </script>
</body>
</html>
